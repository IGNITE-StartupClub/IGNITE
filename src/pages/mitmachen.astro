---
import DefaultLayout from '../layouts/DefaultLayout.astro'
import OpenPositions from '../components/OpenPositions.jsx'
import Questionnaire from '../components/Questionnaire.jsx'
import CallToAction from '../components/CallToAction.astro'
import Feature from '../components/Feature.astro'
import Orb from '../components/Orb/Orb.jsx'

const initialPosition = Astro.url.searchParams.get('position') || ''
export const prerender = false
---

<DefaultLayout
  title="Mitmachen"
  description="Wir freuen uns auf dich im Team von IGNITE - deinem Startup Netzwerk in L√ºneburg!"
>
  <!-- 2) Farbgradient-Overlay (z-0) -->
  <div class="bg-dark pointer-events-none absolute inset-0 z-0"></div>

  <main class="mitmachen-container">
    <!-- Hero Container mit Orb im Hintergrund -->
    <div class="relative h-[600px] w-full">
      <!-- Orb im Hintergrund -->
      <div class="absolute inset-0 z-0">
        <Orb client:load hoverIntensity={0.5} rotateOnHover={true} hue={0} forceHoverState={false} />
      </div>

      <!-- Text absolut zentriert √ºber dem Orb - MIT pointer-events-none -->
      <div class="pointer-events-none absolute inset-0 z-10 flex items-center justify-center px-8">
        <div class="animate-fade-in max-w-2xl text-center text-white [text-shadow:0_4px_4px_rgba(0,0,0,0.8)]">
          <h1 class="mb-6 text-3xl font-extrabold leading-tight sm:text-4xl md:text-5xl lg:text-6xl">
            Entrepreneurship-<br />
            Spirit verbindet
          </h1>
          <p class="mb-8 text-base text-gray-100 sm:text-lg md:text-xl">
            Werde Teil des IGNITE Startup Club L√ºneburg!
          </p>
          <!-- Button braucht pointer-events zur√ºck -->
          <a href="#Bewerbung" class="button secondary js-scroll-center pointer-events-auto"> Jetzt bewerben! </a>
        </div>
      </div>

    </div>
    <!-- Scroll-Cue -->
    <div
      class="pointer-events-none absolute bottom-10 left-1/2 z-20 -translate-x-1/2 transform animate-bounce text-3xl text-white"
    >
      ‚Üì
    </div>

    <!-- OFFENE POSITIONEN (sichtbar, da z-Index kleiner als Content, aber h√∂her als Overlays) -->
    <section id="open-positions" class="relative z-10 py-16">
      <h2 class="text-primary mb-6 text-3xl font-extrabold sm:text-4xl">Unsere Teams</h2>
      <OpenPositions />
    </section>

    <section id="application-form" class="form-section">
      <div class="text-wrapper">
        <h2>Jetzt bewerben!</h2>
        <p>Bewirb dich jetzt ganz einfach und schnell mit diesem Bewerbungsformular.</p>
      </div>
      <section id="Bewerbung">
        <!-- Client-seitig laden, damit React initialPosition auswertet -->
        <Questionnaire client:load initialPosition={initialPosition} />
      </section>
    </section>

    <!-- Bewerbungsprozess Info Section -->
    <section class="application-process-section">
      <h2 class="text-primary mb-8 text-center text-3xl font-extrabold sm:text-4xl">Wie geht es weiter?</h2>
      <p class="process-intro mb-12 text-center text-lg text-gray-300">
        Nach deiner Bewerbung durchl√§ufst du folgende Schritte:
      </p>

      <div class="process-steps">
        <div class="process-step spotlight-card">
          <div class="step-number">1</div>
          <div class="step-content">
            <h3>Bewerbung ausf√ºllen</h3>
            <p>F√ºlle unser Bewerbungsformular aus und erz√§hle uns von dir und deinen Interessen.</p>
          </div>
        </div>

        <div class="process-step spotlight-card">
          <div class="step-number">2</div>
          <div class="step-content">
            <h3>Best√§tigungsmail</h3>
            <p>Du erh√§ltst eine Best√§tigungsmail von uns, dass deine Bewerbung bei uns eingegangen ist.</p>
          </div>
        </div>

        <div class="process-step spotlight-card">
          <div class="step-number">3</div>
          <div class="step-content">
            <h3>Bewerbungsauswertung</h3>
            <p>Wir lesen uns deine Bewerbung durch und entscheiden, ob wir dich zu einem Bewerbungsgespr√§ch einladen.</p>
          </div>
        </div>

        <div class="process-step spotlight-card">
          <div class="step-number">4</div>
          <div class="step-content">
            <h3>Bewerbungsgespr√§ch</h3>
            <p>Das Bewerbungsgespr√§ch wird durch unser HR-Team mit dir durchgef√ºhrt.</p>
          </div>
        </div>

        <div class="process-step spotlight-card">
          <div class="step-number">5</div>
          <div class="step-content">
            <h3>Team-Matching</h3>
            <p>Nach dem Bewerbungsgespr√§ch entscheidet das HR-Team, in welchem Team deiner Auswahl du am besten gerade unterst√ºtzen kannst.</p>
          </div>
        </div>

        <div class="process-step spotlight-card final-step">
          <div class="step-number">üöÄ</div>
          <div class="step-content">
            <h3>Let's ignite your future!</h3>
            <p class="highlight-text">Du bist an Board ‚Äì feel free und willkommen im Team!</p>
          </div>
        </div>
      </div>
    </section>
    <!-- <section>
      <div class="my-24">
        <h2>Unsere Teams</h2>
        <p>
          Unsere Initiative ist in verschiedene Teams unterteilt, die sich auf unterschiedliche Bereiche konzentrieren.
        </p>
        <div class="my-6 grid grid-cols-1 gap-12 md:grid-cols-2 lg:grid-cols-2">
          <Feature src="/team-logos/ignite events.png" title="Events">
            Wir entwickeln neue Veranstaltungsformate, organisieren Events und f√ºhren Workshops durch, um
            unternehmerisches Denken erlebbar zu machen
          </Feature>
          <Feature src="/team-logos/ignite financial.png" title="Finance & Funding">
            Wir k√ºmmern uns um die finanzielle Basis von Ignite ‚Äì durch F√∂rderantr√§ge, Sponsorings, strategische
            Partnerschaften und den Aufbau nachhaltiger Unternehmensbeziehungen.
          </Feature>
          <Feature src="/team-logos/ignite marketing.png" title="Marketing">
            Wir gestalten den Au√üenauftritt von Ignite ‚Äì von Social Media √ºber Printmaterialien bis hin zu Merchandise ‚Äì
            und sorgen daf√ºr, dass unsere Inhalte sichtbar werden.
          </Feature>
          <Feature src="/team-logos/ignite relations.png" title="Relations">
            Wir pflegen enge Verbindungen zur Universit√§t, holen inspirierende Speaker an Bord und st√§rken das Netzwerk
            von Ignite innerhalb und au√üerhalb der Hochschule.
          </Feature>
          <Feature src="/team-logos/ignite community.png" title="Community">
            Wir schaffen ein starkes Gemeinschaftsgef√ºhl im Team ‚Äì mit Onboarding-Prozessen, Team-Events und
            kontinuierlichem Austausch.
          </Feature>
          <Feature src="/team-logos/ignite podcast.png" title="Podcast">
            Wir produzieren inspirierende Podcastfolgen mit spannenden Geschichten von Gr√ºnder:innen und Leuphana-Alumni
            und geben Einblicke in die Startup-Welt.
          </Feature>
        </div>
      </div>
      <CallToAction />
    </section> -->
  </main>

  <script>
    document.querySelectorAll('.js-scroll-center').forEach((btn) => {
      btn.addEventListener('click', (e) => {
        e.preventDefault()
        const targetId = btn.getAttribute('href').slice(1)
        const targetEl = document.getElementById(targetId)
        if (targetEl) {
          targetEl.scrollIntoView({
            behavior: 'smooth',
            block: 'center', // <-- zentriert im Viewport
          })
        }
      })
    })
  </script>

  <script is:inline>
    // Spotlight effect for process steps
    function initProcessSpotlight() {
      const steps = document.querySelectorAll('.process-step.spotlight-card');

      steps.forEach(step => {
        // Remove existing listeners to avoid duplicates
        step.removeEventListener('mousemove', step._spotlightHandler);

        // Define and save handler for cleanup
        step._spotlightHandler = (e) => {
          const rect = step.getBoundingClientRect();
          const x = ((e.clientX - rect.left) / rect.width) * 100;
          const y = ((e.clientY - rect.top) / rect.height) * 100;

          step.style.setProperty('--mouse-x', `${x}%`);
          step.style.setProperty('--mouse-y', `${y}%`);
        };

        step.addEventListener('mousemove', step._spotlightHandler);
      });
    }

    // For initial page load
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initProcessSpotlight);
    } else {
      initProcessSpotlight();
    }

    // For Astro View Transitions (if used)
    document.addEventListener('astro:page-load', initProcessSpotlight);
  </script>

  <style lang="css">
    .mitmachen-container {
      margin: 0 auto;
      padding: 2rem;
      max-width: 800px;
      color: var(--color-text);
      font-family: var(--font-sans);
    }
    .scroll-indicator {
      position: absolute;
      bottom: 2rem;
      left: 50%;
      transform: translateX(-50%);
      animation: bounce 2s infinite;
      font-size: 2rem;
    }
    @keyframes bounce {
      0%,
      100% {
        transform: translate(-50%, 0);
      }
      50% {
        transform: translate(-50%, 10px);
      }
    }

    .intro {
      margin-bottom: 2rem;
      line-height: 1.6;
    }
    h1,
    h2 {
      color: var(--color-primary);
    }
    .form-section {
      margin-top: 3rem;
    }
    #application-form {
      margin: 2rem 0 2rem 0;
    }
    .text-wrapper {
      margin-bottom: 2rem;
    }

    /* Application Process Section */
    .application-process-section {
      margin: 4rem 0;
      position: relative;
      z-index: 10;
    }

    .process-intro {
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }

    .process-steps {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
      max-width: 700px;
      margin: 0 auto;
    }

    .process-step {
      position: relative;
      display: flex;
      align-items: flex-start;
      gap: 1.5rem;
      padding: 1.5rem;
      border-radius: 1rem;
      cursor: pointer;
      overflow: hidden;
      transition: all 0.3s ease;
    }

    .process-step > * {
      position: relative;
      z-index: 2;
    }

    .process-step::before,
    .process-step::after {
      content: '';
      position: absolute;
    }

    .process-step::before {
      inset: 0;
      background-color: var(--dark-100);
      border: 2px solid var(--gradient-100);
      border-radius: 1rem;
      box-shadow: rgba(0, 0, 0, 0.3) 0px 10px 20px, rgba(0, 0, 0, 0.22) 0px 6px 6px;
      z-index: 1;
      transition: all 0.3s ease;
    }

    .process-step::after {
      inset: 0.75rem -0.75rem -0.75rem 0.75rem;
      border-radius: 1rem;
      z-index: 0;
      background: linear-gradient(135deg, transparent, rgba(0,0,0,0.1));
    }

    .process-step:hover::before {
      background: radial-gradient(
        600px circle at var(--mouse-x, 50%) var(--mouse-y, 50%),
        rgba(255, 159, 252, 0.15),
        transparent 40%
      ), var(--dark-100);
      border-color: var(--primary-300);
      box-shadow:
        rgba(0, 0, 0, 0.4) 0px 15px 30px,
        rgba(0, 0, 0, 0.3) 0px 10px 15px,
        0 0 0 1px rgba(255, 255, 255, 0.1);
    }

    .process-step:hover {
      transform: translateY(-2px);
    }

    .step-number {
      flex-shrink: 0;
      width: 3rem;
      height: 3rem;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, var(--primary-300), var(--secondary-300));
      border-radius: 50%;
      font-size: 1.25rem;
      font-weight: bold;
      color: var(--neutral-900);
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
    }

    .step-content {
      flex: 1;
    }

    .step-content h3 {
      color: var(--primary-300);
      font-size: 1.25rem;
      font-weight: bold;
      margin-bottom: 0.5rem;
    }

    .step-content p {
      color: var(--neutral-300);
      line-height: 1.6;
    }

    .final-step {
      background: linear-gradient(135deg, rgba(255, 159, 252, 0.1), rgba(255, 107, 107, 0.1));
    }

    .final-step .step-number {
      background: linear-gradient(135deg, var(--secondary-200), var(--primary-200));
      font-size: 1.5rem;
    }

    .final-step .step-content h3 {
      color: var(--secondary-200);
      font-size: 1.5rem;
    }

    .highlight-text {
      color: var(--primary-200);
      font-weight: 600;
    }

    /* CSS-Variablen im globalen Stylesheet definiert */

    @tailwind utilities;

    @layer utilities {
      @keyframes bg-pan {
        0%,
        100% {
          background-position: 50% 50%;
        }
        50% {
          background-position: 60% 40%;
        }
      }
      .animate-bg-pan {
        animation: bg-pan 20s ease-in-out infinite;
      }
      @keyframes fade-in {
        from {
          transform: translateY(10px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }
      .animate-fade-in {
        opacity: 0;
        animation: fade-in 1s ease-out forwards;
      }
    }
  </style>
</DefaultLayout>
